## 2. 渲染过程

### 2.1 渲染流程

用户请求的HTML文本(text/html)通过浏览器的网络层到达渲染引擎后，渲染工作开始。每次通常渲染不会超过8K的数据块。

渲染流程有四个主要步骤：

1. **解析HTML生成DOM树** - 渲染引擎首先解析HTML文档，生成DOM树
2. **构建Render树** - 接下来不管是内联式，外联式还是嵌入式引入的CSS样式会被解析生成CSSOM树，根据DOM树与CSSOM树生成另外一棵用于渲染的树-渲染树(Render tree)，
3. **布局Render树** - 然后对渲染树的每个节点进行布局处理，确定其在屏幕上的显示位置
4. **绘制Render树** - 最后遍历渲染树并用UI后端层将每一个节点绘制出来

以上步骤是一个渐进的过程，为了提高用户体验，渲染引擎试图尽可能快的把结果显示给最终用户。它不会等到所有HTML都被解析完才创建并布局渲染树。它会在从网络层获取文档内容的同时把已经接收到的局部内容先展示出来。